<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catalyst Ridge Admin Login</title>

  <script src="https://cdn.jsdelivr.net/npm/netlify-identity-widget@1/build/netlify-identity-widget.min.js"></script>

  <style>
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: radial-gradient(circle at 30% 20%, rgba(255,107,90,.25), transparent 45%),
                  radial-gradient(circle at 70% 80%, rgba(168,218,220,.35), transparent 45%),
                  linear-gradient(135deg, #0E5E6F, #1CA7A6);
      padding: 24px;
    }
    .card{
      width:100%;
      max-width:520px;
      background:#fff;
      border-radius:18px;
      box-shadow:0 20px 50px rgba(0,0,0,.18);
      overflow:hidden;
    }
    .top{
      padding:22px 22px 16px 22px;
      color:#fff;
      background: linear-gradient(90deg, #0E5E6F, #A8DADC);
    }
    .top h1{
      margin:0;
      font-size:22px;
      letter-spacing:.2px;
    }
    .top p{
      margin:6px 0 0 0;
      opacity:.9;
      font-size:14px;
    }
    .body{
      padding:18px 22px 22px 22px;
    }
    .btn{
      width:100%;
      border:0;
      border-radius:12px;
      padding:14px 14px;
      background:#FF6B5A;
      color:#fff;
      font-weight:700;
      font-size:16px;
      cursor:pointer;
    }
    .muted{
      margin-top:10px;
      font-size:13px;
      color:#667;
    }
    .status{
      margin-top:14px;
      font-size:14px;
      font-weight:700;
      color:#0E5E6F;
    }
    .err{ color:#B00020; }
    code{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
  </style>
</head>
<body>
  <div class="card">
    <div class="top">
      <h1>Catalyst Ridge Admin</h1>
      <p>Log in to access internal tools.</p>
    </div>

    <div class="body">
      <button class="btn" id="loginBtn">Log in</button>
      <div class="muted">Access is invite only. Use the email you added in Netlify Identity Users.</div>
      <div id="status" class="status"></div>
    </div>
  </div>

  <script>
    const statusEl = document.getElementById("status");
    const loginBtn = document.getElementById("loginBtn");

    function setStatus(msg, isError=false) {
      statusEl.textContent = msg;
      statusEl.className = "status" + (isError ? " err" : "");
    }

    if (!window.netlifyIdentity) {
      setStatus("Netlify Identity widget failed to load.", true);
    } else {
      // If already logged in, go straight to publisher
      netlifyIdentity.on("init", user => {
        if (user) {
          window.location.href = "/admin/publisher/";
        } else {
          setStatus("Not logged in.");
        }
      });

      // After login, redirect to publisher
      netlifyIdentity.on("login", () => {
        window.location.href = "/admin/publisher/";
      });

      // Useful for debugging
      netlifyIdentity.on("error", err => {
        setStatus(err && err.message ? err.message : "Login error.", true);
      });

      loginBtn.addEventListener("click", () => {
        netlifyIdentity.open("login");
      });

      netlifyIdentity.init();
    }
  </script>
</body>
</html>


